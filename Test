#include<lpc214x.h>
#include<stdio.h>
#include<string.h>


/*Functions Decleration */

void delayMS(unsigned char time);
void initPLL(void);
void initUART0(void);
void send_string(char *strptr);
void uart0_write(char data);
void initLCD8bit(void);
void lcd_cmd(unsigned char cmd);
void lcd_data(unsigned char d);
void lcd_str_print(char *lcdptr);

/* GSM related Functions */

void initGSM(void);







int main()
{
	
	// initPLL();
	

}

void delayMS(unsigned char time)
{
	//Configuring timer for 1 sec delay
	
	
	T0CTCR=0x00; //setting timer in timer mode
	T0PR=59999;
	T0TCR=0x02; //reset timer

	T0TCR=0x01; //enable timer
			
	while (T0TC < time ); //stay here until TC reaches desired delay
	
	T0TCR=0x00; //disable timer

	
}

void initPLL(void)
{
	PLL0CON=0x01;
	PLL0CFG=0x24; //M=4,P=2,Fosc=12MHz,CCLK=60Mhz
	PLL0FEED=0xAA;//feed sequence
	PLL0FEED=0x55;
	
	while(!(PLL0STAT & 0x00000400)) ;  wait here until PLL gets in locked status
	
	PLL0CON=0x03;
	PLL0FEED=0xAA;//feed sequence
	PLL0FEED=0x55;
	
	VPBDIV=0x01;

}

void initUART0(void)
{

 // UART set at 9600Mhz PCLK=60Mhz MulVal=15 DivAddVal=0
	U0LCR=0x83;
	U0DLL=110;
	U0DLM=1;
	U0FDR=0xF1;
	U0LCR &= 0x7F;

}


void send_string(char *strptr)
{
	while(strptr != '\0 ' )  /* error */
		{
			uart0_write(*strptr);
			strptr++ ;
		}

}


void uart0_write(char data)
{
	while ( ! ( U0LSR & (1<<5) )  ); //wait here until THR gets empty
		
	U0THR=data;
}


void initLCD8bit(void)
{
	/*intializing pins for lcd 
	
		data --> PORT1.16 to PORT1.23
		rs--> PORT1.24
		rw--> PORT1.25
		en--> PORT1.26

	 */

		IO1DIR = 0x07FF0000 // making data,rs,rw,en as output port
		delayMS(1000);
				

	/* Initializing LCD */
	lcd_cmd(0x38); //2-lines 5X7 matrix
	delayMS(1000); 
	lcd_cmd(0x0E); //display on cursor on
	delayMS(1000);
	lcd_cmd(0x06); // Auto increment cursor 
	delayMS(1000);
	lcd_cmd(0x80); // force cursor to the beginning of 1st line
	delayMS(1000); 
	
}


void lcd_cmd(unsigned char cmd)
{
	


}
void lcd_data(unsigned char d);
void lcd_str_print(char *lcdptr);
